<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Recibo LayAway</title>
  <style>
    body { font-family: monospace; margin:0; padding:8px; }
    .receipt { white-space: pre-wrap; }
    .note { color: #888; font-size: 0.9em; margin-top:16px; }
  </style>
  <script>
    // 1) Leer parámetros individuales
    const params = new URLSearchParams(location.search);
    const key   = params.get('layawaykey') || '<¡faltante!>';
    const name  = params.get('name')       || '<¡faltante!>';
    const phone = params.get('phone')      || '<¡faltante!>';
    const date  = params.get('startdate')  || '<¡faltante!>';
    const total = params.get('totalamt')   || '<¡faltante!>';
    const notas = params.get('notas')      || '<¡faltante!>';

    // 2) Construir bloque plano
    const block =
`╔════════════════════╗
║      LAYAWAY       ║
╚════════════════════╝
Key:       ${key}
Cliente:   ${name}
Teléfono:  ${phone}
Fecha:     ${date}
Monto:     S/${total}
Notas:     ${notas}

`;

    // 3) Mostrarlo en pantalla para verificar
    document.addEventListener('DOMContentLoaded', () => {
      document.body.innerHTML =
        `<div class="receipt">${block}</div>` +
        `<div class="note">Imprimiendo en 1 s…</div>`;
    });

    // 4) Disparar impresión en RawBT tras 1 s
    setTimeout(() => {
      const uri = 'rawbt://print?contentType=raw&content='
                + encodeURIComponent(block);
      window.location.href = uri;
    }, 1000);
  </script>
</head>
<body>
  <!-- Aquí aparecerá el recibo generado -->
</body>
</html>
